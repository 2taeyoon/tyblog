`NextJS`ì—ì„œ `JSON`ì„ ê¸°ë°˜ìœ¼ë¡œ ë™ì  ë¼ìš°íŒ…ì´ ì„¤ì •ë˜ì–´ ìˆëŠ”ë°ìš”. ì´ë²ˆì— ìë™ìœ¼ë¡œ ë™ì  `sitemap.xml`ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.

ê¸°ì¡´ì˜ ì •ì ì¸ `sitemap`ì„ ë™ì ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ê³¼ `JSON` ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ `sitemap`ì„ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ”ì§€ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.

***

## ğŸ¦® ê¸°ì¡´ Sitemap vs ë³€ê²½ëœ Sitemap

ìš°ì„  ê¸°ì¡´ì˜ `sitemap.xml`ê³¼ ìš°ë¦¬ê°€ ìƒˆë¡­ê²Œ ë³€ê²½í•  `sitemap.xml`ì˜ ì°¨ì´ì ì„ ë¨¼ì € ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

```xml
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
	<url>
		<loc>https://www.2taeyoon.com</loc>
		<priority>1.0</priority>
	</url>
	<url>
		<loc>https://www.2taeyoon.com/ds</loc>
		<priority>0.8</priority>
	</url>
	<url>
		<loc>https://www.2taeyoon.com/ps</loc>
		<priority>0.8</priority>
	</url>
	<url>
		<loc>https://www.2taeyoon.com/es</loc>
		<priority>0.8</priority>
	</url>
</urlset>
```

ğŸ“Œ **ë¬¸ì œì **

* ê³ ì •ëœ URLë§Œ ë“±ë¡ë¨ (ìƒˆë¡œìš´ ê¸€ì´ ì¶”ê°€ë˜ë©´ sitemap.xmlì„ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì •í•´ì•¼ í•¨â€¦ êµ‰ì¥íˆ ë¶ˆí¸)
* ë¸”ë¡œê·¸ ê¸€(í¬ìŠ¤íŠ¸)ì˜ ê° ê°œë³„ í˜ì´ì§€ê°€ ë“±ë¡ë˜ì§€ ì•ŠìŒ â†’ ê²€ìƒ‰ì—”ì§„ì´ ìƒˆë¡œìš´ ê¸€ì„ ë°œê²¬í•˜ëŠ” ì†ë„ê°€ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŒ!

***

### ğŸ¦„ App Router ê¸°ë°˜ì˜ sitemap ìƒì„±

<img src="/images/front_study/23/image1.webp"/>

ì‚¬ì§„ê³¼ ê°™ì´ ì €ëŠ” `NextJS`ì—ì„œ `App Router` ê¸°ë°˜ìœ¼ë¡œ ë¼ìš°íŒ…ì„ êµ¬í˜„í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì¦‰, `app` í´ë” ì•ˆì—ì„œ í´ë” ê¸°ë°˜ìœ¼ë¡œ ë¼ìš°íŒ…ì´ êµ¬í˜„ë˜ê³  ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.

ì •ì ì¸ `sitemap.xml`ì€ `public` í´ë”ì— ë„£ê¸°ë§Œ í•˜ë©´ ë˜ì§€ë§Œ ë™ì ì¸ `sitemap` ìƒì„±ì„ ìœ„í•´ì„œëŠ” `sitemap.xml`ì´ë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

`NextJS`ì˜ `App Router` êµ¬ì¡°ì—ì„œëŠ” API ë¼ìš°íŠ¸ë¥¼ ë§Œë“¤ ë•Œ í´ë” ê¸°ë°˜ìœ¼ë¡œ ê´€ë¦¬ë¥¼ í•´ì•¼í•©ë‹ˆë‹¤. ì¦‰, `app/ì‚¬ìš©í•  API/route.ts` íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤!

***

### ğŸ¦„ NextJSì˜ route.tsë¡œ Sitemap ë™ì ìœ¼ë¡œ ë§Œë“¤ê¸°!

<img src="/images/front_study/23/image2.webp"/>

ìœ„ì™€ ê°™ì´ `app` í´ë” ì•ˆì— `sitemap.xml` í´ë”ë¥¼ ë§Œë“¤ê³  ê·¸ ì•ˆì— `route.ts` íŒŒì¼ì„ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.
ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ `route.ts` íŒŒì¼ì´ ì–´ë–»ê²Œ `sitemap`ì„ ìƒì„±í•˜ëŠ”ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

<br/>

#### âœ… JSON ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

```ts
import { NextResponse } from "next/server";
import DesignCard from "@/data/designStudyData.json";
import PublishingCard from "@/data/publishingStudyData.json";
import EtcCard from "@/data/etcStudyData.json";
import { CardProps } from "@/types/props";
```

ì €ëŠ” JSONì„ ì´ìš©í•´ì„œ ë™ì  ë¼ìš°íŒ…ì„ êµ¬í˜„í•˜ê³  ìˆê³  í•´ë‹¹ JSONì˜ `title` ìš”ì†Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ urlì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ í•„ìš”í•œ JSON íŒŒì¼ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.

<br/>

#### âœ… ëª¨ë“  ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ ë°°ì—´ë¡œ í•©ì¹˜ê¸°

```ts
const combinedData: CardProps[] = [
  ...DesignCard.cards,
  ...PublishingCard.cards,
  ...EtcCard.cards,
];
```

<br/>

#### âœ… Sitemapì— ì¶”ê°€í•  ë™ì  URL ìƒì„±

```ts
async function getDynamicPaths(): Promise<{ url: string; }[]> {
  return combinedData.map((item) => {
    const encodedTitle = encodeURIComponent(item.title.replace(/\s+/g, "-"));
    return { url: `/${item.type}/${encodedTitle}` };
  });
}
```

* `combinedData`ì„ ë§µí•‘í•˜ë©° ê²Œì‹œê¸€ì˜ ì œëª©ì„ ê¸°ë°˜ìœ¼ë¡œ URLì„ ìƒì„±í•©ë‹ˆë‹¤.
* `replace`ë¡œ ì •ê·œì‹ì„ ì´ìš©í•´ `ê³µë°±`ëŒ€ì‹  `-`ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.
* í•´ë‹¹ í•¨ìˆ˜ì—ì„œëŠ” `await`ê°€ ì—†ì–´ì„œ êµ³ì´ `async`ë¥¼ ì•ˆ ì¨ë„ ì‘ë™í•˜ì§€ë§Œ ë‹¤ë¥¸ ì½”ë“œì—ì„œ `await` í˜¸ì¶œë˜ë¯€ë¡œ ì‚¬ìš©

<br/>

ğŸ“Œ **url ë³€í™˜ ì˜ˆì‹œ**
* `NextJS 15 ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜¤ë¥˜ í•´ê²°ê¸°` -> `NextJS-15-ë§ˆì´ê·¸ë ˆì´ì…˜-ì˜¤ë¥˜-í•´ê²°ê¸°`
* `Dockerë€ ë¬´ì—‡ì¸ê°€` -> `Dockerë€-ë¬´ì—‡ì¸ê°€`

<br/>

#### âœ… Sitemapì— ì¶”ê°€í•  ë™ì  URL ìƒì„±

```ts
function generateSitemap(paths: { url: string; }[]) {
  const domain = "https://www.2taeyoon.com";
  return `<?xml version="1.0" encoding="UTF-8"?>
  <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
    <url>
		<loc>${domain}</loc>
		<changefreq>weekly</changefreq>
		<priority>1.0</priority>
	</url>
    <url>
		<loc>${domain}/ds</loc>
		<changefreq>weekly</changefreq>
		<priority>1.0</priority>
	</url>
    <url>
		<loc>${domain}/ps</loc>
		<changefreq>weekly</changefreq>
		<priority>1.0</priority>
	</url>
    <url>
		<loc>${domain}/es</loc>
		<changefreq>weekly</changefreq>
		<priority>1.0</priority>
	</url>
    ${paths.map((path) =>
			`
     		<url>
					<loc>${domain}${path.url}</loc>
					<changefreq>weekly</changefreq>
					<priority>0.8</priority>
      	</url>
    	`
		).join("")}
  </urlset>`;
}
```

* ê¸°ë³¸ ê²½ë¡œ`(/, /ds, /ps, /es)` ì¶”ê°€í•©ë‹ˆë‹¤.
* `paths.map()`ì„ ì´ìš©í•´ ë™ì ìœ¼ë¡œ ê²Œì‹œê¸€ ê²½ë¡œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
* `path.map` ë¶€ë¶„ì˜ ë§ˆì§€ë§‰ì— `.join("")`ì„ ì‚¬ìš©í•´ì•¼ ë°°ì—´ í˜•íƒœë¡œ ì¶œë ¥ë˜ëŠ” ìš”ì†Œë“¤ì„ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ í•©ì³ì¤ë‹ˆë‹¤.

<br/>

#### âœ… NextJS API Routeë¡œ ì‘ë‹µ ë°˜í™˜

```ts
export async function GET() {
  const paths = await getDynamicPaths();
  const sitemap = generateSitemap(paths);
  return new NextResponse(sitemap, {
    headers: { "Content-Type": "application/xml" },
  });
}
```

* ìƒìˆ˜ `paths`ëŠ” `getDynamicPaths` í•¨ìˆ˜ì—ì„œ ë°˜í™˜ë°›ì€ `/${item.type}/${encodedTitle}` ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
* ìƒìˆ˜ `sitemap`ì€ ë°˜í™˜ë°›ì€ `paths` ê°’ì„ `generateSitemap`ì˜ ì¸ìˆ˜ë¡œ ë„£ìŠµë‹ˆë‹¤.
* `GET()` ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ìë™ìœ¼ë¡œ ìƒìˆ˜ `Sitemap`ì„ ìƒì„±í•©ë‹ˆë‹¤. ì¦‰, `generateSitemap`ì˜ `return` ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì¶”ê°€ì ìœ¼ë¡œ ì‘ë‹µ í—¤ë”ì˜ `Content-Type`ì„ `application/xml`ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

<br/>

#### âŒ Error: A conflicting public file and page file was found for path /sitemap.xml

<img src="/images/front_study/23/image3.webp"/>

ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´ ë™ì¼í•œ ê²½ë¡œ `/sitemap.xml`ì— ë™ì  í˜ì´ì§€`(API Route)`ê°€ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì¦‰, `public/sitemap.xml` íŒŒì¼ê³¼ `app/sitemap.xml/route.ts(API Route)`ê°€ ì¤‘ë³µë˜ì–´ ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²ƒì…ë‹ˆë‹¤.

ì´ë•Œì—ëŠ” ê°„ë‹¨íˆ `public` í´ë”ì— ìˆëŠ” `sitemap.xml` íŒŒì¼ì„ ì‚­ì œí•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.

***

## ğŸ¦® ê²°ë¡ 

<img src="/images/front_study/23/image4.webp"/>

ì‚¬ì§„ê³¼ ê°™ì´ `ì‚¬ì´íŠ¸url/sitemap.xml`ì— ë“¤ì–´ê°€ë©´ `sitemap`ì´ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•´ì„œ `JSON` ê¸°ë°˜ìœ¼ë¡œ `sitemap` ìƒì„±í•˜ê¸° ì™„ì„±!

* `ì •ì  Sitemap` â†’ `ë™ì  Sitemap`ìœ¼ë¡œ ê°œì„ í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ ë¶€ë‹´ì„ ì¤„ì˜€ìŠµë‹ˆë‹¤.
* ì´ì œ ìƒˆë¡œìš´ ê¸€ì„ ì¶”ê°€í•  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ `Sitemap`ì´ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤!